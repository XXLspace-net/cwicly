window.addEventListener("DOMContentLoaded",function(){const t=document.querySelectorAll('[data-cc-woo-type="variable"]');t.length&&t.forEach(t=>{new CCWooVariables(t)});const e=document.querySelector(".woocommerce.single-product.variable-product");e&&new CCWooVariables(e),addEventListener("change",t=>{if(t.target.matches("select.cc-swatch")){t.preventDefault();const e=t.target,i=e.closest("[data-cc-id]")?e.closest("[data-cc-id]"):!!e.closest(".woocommerce.single-product")&&e.closest(".woocommerce.single-product"),a=specificMaker(i),c=i.getAttribute("data-cc-id")?i.getAttribute("data-cc-id"):!!CCers.postID&&CCers.postID,o=!!t.target.options[t.target.selectedIndex].getAttribute("data-variation")&&t.target.options[t.target.selectedIndex].getAttribute("data-variation"),s=t.target.options[t.target.selectedIndex].getAttribute("value")?t.target.options[t.target.selectedIndex].getAttribute("value"):"",n=new CustomEvent(`cc-woo-${c}${a}`,{detail:{variation:[o,s]}});document.dispatchEvent(n)}else if(t.target.matches("[cc-woo-quantity]")){const e=t.target;let i;i=e.closest("[data-cc-id]")?e.closest("[data-cc-id]").getAttribute("data-cc-id"):CCers.postID;const a=specificMaker(e);window[`cc-woo-qty-${i}${a}`]=e.value}}),document.addEventListener("cc-woo-cart-mod",t=>{if(t.detail){document.querySelectorAll("[cc-appearance]").forEach(t=>{const e=t.getAttribute("cc-appearance"),i=t.closest(".cc-mdl");if(i){const t=i.id;window[`cc-modal-${t}`].open(),e&&setTimeout(()=>{window[`cc-modal-${t}`].close()},1e3*e)}const a=t.closest("[data-ccp-state]");if(a){const t=a.id;window[`cc-popover-${t}`].open(),e&&setTimeout(()=>{window[`cc-popover-${t}`].close()},1e3*e)}})}})});class CCWooVariables{constructor(t){this.$el=t,this.selectors=this.$el.querySelectorAll("[data-variation][data-value]"),this.id=this.$el.getAttribute("data-cc-id")?this.$el.getAttribute("data-cc-id"):!!CCers.postID&&CCers.postID,this.data=this.$el.getAttribute("data-cc-woo-variations")?JSON.parse(this.$el.getAttribute("data-cc-woo-variations")):!!(CCers.woo&&CCers.woo.mainVariations&&CCers.woo.mainVariations.variations)&&JSON.parse(CCers.woo.mainVariations.variations),this.defaults=this.$el.getAttribute("data-cc-woo-default-variations")?JSON.parse(this.$el.getAttribute("data-cc-woo-default-variations")):!!(CCers.woo&&CCers.woo.mainVariations&&CCers.woo.mainVariations.default_variations)&&JSON.parse(CCers.woo.mainVariations.default_variations),this.selected={...this.defaults},this.onListen=this.onListen.bind(this),this.sliders=[],this.parent=this.$el.closest("[data-cc-id]")?this.$el.closest("[data-cc-id]"):!!this.$el.closest(".woocommerce.single-product")&&this.$el.closest(".woocommerce.single-product"),this.specific=specificMaker(this.$el),this.init(),this.initialInfo()}init(){if(document.addEventListener(`cc-woo-${this.id}${this.specific}`,this.onListen),!window[`cc-woo-defaults-${this.id}`]){const t=this.parent,e=specificElementer("[data-variation_price]",t)?specificElementer("[data-variation_price]",t).innerHTML:null,i=specificElementer("[data-variation_salepric]",t)?specificElementer("[data-variation_salepric]",t).innerHTML:null,a=specificElementer("[data-variation_regularprice]",t)?specificElementer("[data-variation_regularprice]",t).innerHTML:null,c=specificElementer("[data-variation_description]",t)?specificElementer("[data-variation_description]",t).innerHTML:null;window[`cc-woo-defaults-${this.id}`]={price:e,saleprice:i,regularprice:a,description:c}}if(this.checkVariation(),this.$el===document.body)this.sliders=specificElementerAll("[data-cc-woo-slider]",this.$el);else if(this.$el.closest("[data-cc-id]")){this.$el.querySelectorAll("[data-cc-woo-slider]").forEach(t=>{this.sliders.push(t)})}}onListen(t){if(t.detail)if(t.detail.reset)this.selected={...this.defaults},this.resetDefaults(),this.checkVariation();else{const[e,i]=t.detail.variation;this.selected[e]===i?this.selected[e]="":this.selected[e]=i,this.checkVariation()}}checkVariation(){Object.entries(this.selected).forEach(([t,e])=>{this.changeVariationState(t,e)});const t=this.findMatchingVariations(this.data,this.selected);this.checkIfOptionIsSelectable();const e=t.shift(),i=!Object.values(this.selected).every(t=>null!==t&&""!==t);if(e&&!i){const t=Object.entries(e.attributes).map(([t,i])=>({attribute:e.attributes_full[t.replace("attribute_","")],value:this.selected[t.replace("attribute_","")]}));window[`cc-woo-${this.id}${this.specific}`]=t,this.addToCartButtonState(!0),this.changeContent("data-variation_price",e,"price"),this.changeContent("data-variation_saleprice",e,"sale_price"),this.changeContent("data-variation_regularprice",e,"regular_price"),this.changeContent("data-variation_salepercentage",e,"sale_percentage"),e.image_id&&this.slideToImage(e.image_id),this.conditionChecker(e)}else this.addToCartButtonState(!1)}addToCartButtonState(t){const e=specificElementerAll("[data-cc-add-to-cart]",this.parent);e.length&&e.forEach(function(e){t?e.removeAttribute("disabled"):e.setAttribute("disabled","")})}changeVariationState(t,e){const i=this.$el.querySelectorAll(`[data-variation="${t}"]`);let a=[];this.parent===document.body?i.forEach(function(t){t.closest("[data-cc-id]")||a.push(t)}):a=i,a&&a.length&&a.forEach(function(t){t.parentElement&&t.parentElement.tagName&&"SELECT"===t.parentElement.tagName?t.parentElement.value=e:t.getAttribute("data-value")===e?!1===t.classList.contains("selected")&&t.classList.add("selected"):!0===t.classList.contains("selected")&&t.classList.remove("selected")})}changeContent(t,e,i){const a=specificElementerAll(`[${t}]`,this.$el)?specificElementerAll(`[${t}]`,this.$el):null;a&&a.length&&a.forEach(function(a){if("data-variation_price"===t||"data-variation_regularprice"===t||"data-variation_saleprice"===t){const c=a.getAttribute(t)?a.getAttribute(t):"";a.innerHTML=c&&e[i]&&e[i][c]?e[i][c]:e[i]&&e[i].blank?e[i].blank:""}else"data-variation_salepercentage"===t?this.replaceInnerNotSpan(a,e[i]?e[i]:null):a.innerHTML=e},this)}checkIfOptionIsSelectable(){const t=this.$el.querySelectorAll("[data-variation]");let e=[];this.parent===document.body?t.forEach(function(t){t.closest("[data-cc-id]")||e.push(t)}):e=t,e.length&&e.forEach(function(t){const e={...this.selected};e[t.getAttribute("data-variation")]="",this.findMatchingVariations(this.data,e).filter(function(e){return e.is_in_stock&&(e.attributes[`attribute_${t.getAttribute("data-variation")}`]===t.getAttribute("data-value")||e.attributes[`attribute_${t.getAttribute("data-variation")}`]===t.getAttribute("value")||""===e.attributes[`attribute_${t.getAttribute("data-variation")}`])}).length?t.removeAttribute("disabled"):t.setAttribute("disabled","")},this)}resetDefaults(){window[`cc-woo-defaults-${this.id}`].price&&specificElementerAll("[data-variation_price]",this.$el).forEach(function(t){t.innerHTML=window[`cc-woo-defaults-${this.id}`].price},this),window[`cc-woo-defaults-${this.id}`].description&&specificElementerAll("[data-variation_description]",this.$el).forEach(function(t){t.innerHTML=window[`cc-woo-defaults-${this.id}`].description},this)}findMatchingVariations(t,e){for(var i=[],a=0;a<t.length;a++){var c=t[a];this.isMatch(c.attributes,e)&&i.push(c)}return i}isMatch(t,e){var i=!0;for(var a in t){const s=a.replace("attribute_","");if(t.hasOwnProperty(a)){var c=t[a],o=e[s];void 0!==c&&void 0!==o&&0!==c.length&&0!==o.length&&c!==o&&(i=!1)}}return i}slideToImage(t){this.sliders&&this.sliders.forEach(function(e){const i=e.id,a=e.querySelectorAll(".splide__slide");a.length&&a.forEach(function(e,a){e.getAttribute("data-cc-image-id")&&parseInt(e.getAttribute("data-cc-image-id"))===t&&window[`cc-${i}`].go(a)},this)},this)}conditionChecker(t){specificElementerAll("[data-cc-woo-c-onsale]",this.$el).forEach(function(e){"true"===e.getAttribute("data-cc-woo-c-onsale")?t.on_sale?(e.removeAttribute("hidden"),e.removeAttribute("cc-hidden")):(e.setAttribute("hidden","true"),e.setAttribute("cc-hidden","true")):t.on_sale?(e.setAttribute("hidden","true"),e.setAttribute("cc-hidden","true")):(e.removeAttribute("hidden"),e.removeAttribute("cc-hidden"))},this)}initialInfo(){specificElementerAll("[data-variation_price]",this.$el).forEach(t=>{(t.getAttribute("data-cc-woo-c-onsale")&&"false"===t.getAttribute("data-cc-woo-c-onsale")||!t.getAttribute("data-cc-woo-c-onsale"))&&(t.removeAttribute("hidden"),t.removeAttribute("cc-hidden"))})}replaceInnerNotSpan(t,e){if(t&&e)if(t.querySelector(".before")&&t.querySelector(".after")){const i=t.innerHTML,a=i.indexOf('<span class="before">'),c=i.indexOf("</span>",a),o=i.indexOf("</span>",a)+"</span>".length,s=i.indexOf("</span>",c)+"</span>".length;t.innerHTML=i.slice(0,o)+e+i.slice(s)}else if(t.querySelector(".before")){const i=t.innerHTML,a=i.indexOf('<span class="before">'),c=i.indexOf("</span>",a)+"</span>".length;t.innerHTML=i.slice(0,c)+e}else if(t.querySelector(".after")){const i=t.innerHTML,a=i.indexOf('<span class="after">'),c=i.indexOf("</span>",a)+"</span>".length;t.innerHTML=i.slice(0,c)+e}else t.innerHTML=e}}function cc_woo(t){const e=document.querySelectorAll("[data-cc-add-to-cart]");e.length&&e.forEach(function(e){if(e===t.target||e.contains(t.target)){const t=e.closest("[data-cc-woo-type]")?e.closest("[data-cc-woo-type]"):!!e.closest(".woocommerce.single-product")&&e.closest(".woocommerce.single-product"),i=t.getAttribute("data-cc-woo-type")?t.getAttribute("data-cc-woo-type"):t?CCers.woo&&CCers.woo.mainVariations?"variable":"simple":null,a=specificMaker(e),c=1500;if(t){const o=t.getAttribute("data-cc-id")?t.getAttribute("data-cc-id"):t?CCers.postID:null;if("variable"===i){const t=window[`cc-woo-${o}${a}`];if(t&&(e.classList.add("loading"),CCers&&CCers.woo&&CCers.woo.nonce)){let i=1;window[`cc-woo-qty-${o}${a}`]&&(i=window[`cc-woo-qty-${o}${a}`]),fetch(`${CCers.restBase}/wc/store/v1/cart/add-item?id=${o}&quantity=${i}`,{method:"POST",headers:{"X-WP-Nonce":CCers.nonce,Nonce:CCers.woo.nonce,"Content-Type":"application/json"},body:JSON.stringify({variation:t})}).then(t=>t.json()).then(t=>{if(t){e.classList.remove("loading"),e.classList.add("added");const i=new CustomEvent("cc-woo-cart-mod",{detail:{cart:t}});document.dispatchEvent(i),setTimeout(()=>{e.classList.remove("added")},c)}}).catch(t=>console.error(t))}}else if(t.querySelector("[cc-woo-grouped]")){const i=t.querySelector("[cc-woo-grouped]").querySelectorAll("[data-cc-id]");CCers&&CCers.woo&&CCers.woo.nonce&&i.length&&(e.classList.add("loading"),i.forEach(function(t,o){setTimeout(()=>{const s=t.getAttribute("data-cc-id");let n=1;window[`cc-woo-qty-${s}${a}`]&&(n=window[`cc-woo-qty-${s}${a}`]),fetch(`${CCers.restBase}/wc/store/v1/cart/add-item?id=${s}&quantity=${n}`,{method:"POST",headers:{"X-WP-Nonce":CCers.nonce,Nonce:CCers.woo.nonce}}).then(t=>t.json()).then(t=>{if(t&&o===i.length-1){e.classList.remove("loading"),e.classList.add("added");const i=new CustomEvent("cc-woo-cart-mod",{detail:{cart:t}});document.dispatchEvent(i),setTimeout(()=>{e.classList.remove("added")},c)}}).catch(t=>console.error(t))},500*o)}))}else if(!(null!==e.getAttribute("disabled")&&void 0!==e.getAttribute("disabled")||null!==e.getAttribute("data-cc-redirect")&&void 0!==e.getAttribute("data-cc-redirect"))&&(e.classList.add("loading"),CCers&&CCers.woo&&CCers.woo.nonce)){let t=1;window[`cc-woo-qty-${o}${a}`]&&(t=window[`cc-woo-qty-${o}${a}`]),fetch(`${CCers.restBase}/wc/store/v1/cart/add-item?id=${o}&quantity=${t}`,{method:"POST",headers:{"X-WP-Nonce":CCers.nonce,Nonce:CCers.woo.nonce}}).then(t=>t.json()).then(t=>{if(t){e.classList.remove("loading"),e.classList.add("added");const i=new CustomEvent("cc-woo-cart-mod",{detail:{cart:t}});document.dispatchEvent(i),setTimeout(()=>{e.classList.remove("added")},c)}}).catch(t=>console.error(t))}}}});const i=document.querySelectorAll("[data-cc-woo-reset]");i.length&&i.forEach(function(e){if(e===t.target||e.contains(t.target)){const t=e.closest('[data-cc-woo-type="variable"]');if(t){const i=t.getAttribute("data-cc-id"),a=specificMaker(e),c=new CustomEvent(`cc-woo-${i}${a}`,{detail:{reset:!0}});document.dispatchEvent(c)}}});const a=document.querySelectorAll("[data-variation][data-value]");a.length&&a.forEach(function(e){if(e===t.target||e.contains(t.target))if(t.preventDefault(),e.hasAttribute("disabled"));else if(e.closest("[data-cc-id]")||e.closest(".woocommerce.single-product")){const t=e.closest("[data-cc-id]")&&e.closest("[data-cc-id]").getAttribute("data-cc-id")?e.closest("[data-cc-id]").getAttribute("data-cc-id"):!!CCers.postID&&CCers.postID;if(t){const i=!!e.getAttribute("data-variation")&&e.getAttribute("data-variation"),a=!!e.getAttribute("data-value")&&e.getAttribute("data-value"),c=specificMaker(e),o=new CustomEvent(`cc-woo-${t}${c}`,{detail:{variation:[i,a]}});document.dispatchEvent(o)}}}),stepper("stepdown",t),stepper("stepup",t)}function stepper(t,e){document.querySelectorAll(`[data-cc-woo-${t}]`).forEach(function(i){if((i===e.target||i.contains(e.target))&&(e.preventDefault(),i.closest("[data-cc-id]")||i.closest(".woocommerce.single-product"))){const e=i.closest("[data-cc-id]")||i.closest(".woocommerce.single-product"),a=i.closest("[data-cc-id]")&&i.closest("[data-cc-id]").getAttribute("data-cc-id")?i.closest("[data-cc-id]").getAttribute("data-cc-id"):!!CCers.postID&&CCers.postID;if(a){const c=specificElementer("[cc-woo-quantity]",e),o=c.getAttribute("min")?c.getAttribute("min"):1,s=c.getAttribute("max")?c.getAttribute("max"):999,n=specificMaker(i);let r=1;window[`cc-woo-qty-${a}${n}`]&&(r=window[`cc-woo-qty-${a}${n}`]),r?("stepdown"===t?r=parseInt(r)-1<o?o:parseInt(r)-1:"stepup"===t&&(r=parseInt(r)+1>s?s:parseInt(r)+1),window[`cc-woo-qty-${a}${n}`]=r):(r=1,window[`cc-woo-qty-${a}${n}`]=r),specificElementerAll("[cc-woo-quantity]",e).forEach(function(t){t.value=r})}}})}function specificMaker(t){return t.closest("[data-query_id]")&&t.closest("[data-query_id]").getAttribute("data-query_id")&&t.closest("[data-cc-id]").getAttribute("data-cc-id")?`-${t.closest("[data-query_id]").getAttribute("data-query_id")}-${t.closest("[data-cc-id]").getAttribute("data-cc-id")}`:""}function specificElementer(t,e){const i=e.querySelector(t);let a=[];return i&&i.length&&e===document.body?i.forEach(function(t){t.closest("[data-cc-id]")||a.push(t)}):a=i,a}function specificElementerAll(t,e){const i=e.querySelectorAll(t);let a=[];return e===document.body?i.forEach(function(t){t.closest("[data-cc-id]")||a.push(t)}):a=i,a}